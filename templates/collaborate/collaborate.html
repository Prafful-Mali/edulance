{% extends 'base.html' %}
{% load static %}

{% block title %}Collaborate - Edulance{% endblock %}

{% block extra_css %}
<link href="https://cdn.jsdelivr.net/npm/tom-select/dist/css/tom-select.css" rel="stylesheet">
<link rel="stylesheet" href="{% static 'post/collaborate/collaborate.css' %}">
{% endblock %}

{% block content %}
<div class="container mt-5">
  <div id="loadingSpinner" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div class="d-flex flex-wrap justify-content-between align-items-center mb-4">
    <div>
      <h2>Collaboration Posts</h2>
      <p class="text-muted">Find team members for hackathons and group projects</p>
    </div>
    <button class="btn btn-primary-custom btn-custom" data-bs-toggle="modal" data-bs-target="#createPostModal">
      <i class="bi bi-plus-circle me-1"></i> Create Post
    </button>
  </div>

  <div class="card filter-card mb-5">
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Project Type</label>
          <select class="form-select" id="filterProjectType">
            <option value="">All Types</option>
            <option value="hackathon">Hackathon</option>
            <option value="group_project">Group Project</option>
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label">&nbsp;</label>
          <button class="btn btn-outline-secondary-custom w-100 btn-custom" id="clearFilters">Clear Filters</button>
        </div>
      </div>
    </div>
  </div>

  <h3 class="mb-3">My Posts</h3>
  <div class="row mb-5" id="myPostsContainer"></div>

  <h3 class="mb-3">All Posts</h3>
  <div class="row" id="postsContainer"></div>
</div>

<div class="modal fade" id="createPostModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title fw-semibold">Create New Post</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="createPostForm">
          <div class="mb-3">
            <label class="form-label">Title *</label>
            <input type="text" class="form-control" id="postTitle" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Description *</label>
            <textarea class="form-control" id="postDescription" rows="4" required></textarea>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Project Type *</label>
              <select class="form-select" id="postProjectType" required>
                <option value="">Select Type</option>
                <option value="hackathon">Hackathon</option>
                <option value="group_project">Group Project</option>
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">People Required *</label>
              <input type="number" class="form-control" id="postPeopleRequired" min="1" required>
            </div>
          </div>
          <div class="row">
            <div class="col-md-4 mb-3">
              <label class="form-label">Application Deadline *</label>
              <input type="datetime-local" class="form-control" id="postLastDate" required>
            </div>
            <div class="col-md-4 mb-3">
              <label class="form-label">Event Start *</label>
              <input type="datetime-local" class="form-control" id="postEventStart" required>
            </div>
            <div class="col-md-4 mb-3">
              <label class="form-label">Event End *</label>
              <input type="datetime-local" class="form-control" id="postEventEnd" required>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">Required Skills</label>
            <select id="skillsSelect" class="form-select" multiple></select>
            <small class="text-muted">Select or type new skills.</small>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="submitPostBtn">Create Post</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="editPostModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header text-dark">
        <h5 class="modal-title fw-semibold">Edit Post</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="editPostForm">
          <input type="hidden" id="editPostId">
          <div class="mb-3">
            <label class="form-label">Title *</label>
            <input type="text" class="form-control" id="editPostTitle" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Description *</label>
            <textarea class="form-control" id="editPostDescription" rows="4" required></textarea>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Project Type *</label>
              <select class="form-select" id="editPostProjectType" required>
                <option value="hackathon">Hackathon</option>
                <option value="group_project">Group Project</option>
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">People Required *</label>
              <input type="number" class="form-control" id="editPostPeopleRequired" min="1" required>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">Required Skills</label>
            <select id="editSkillsSelect" class="form-select" multiple></select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary text-white" id="saveEditBtn">Save Changes</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/tom-select/dist/js/tom-select.complete.min.js"></script>
<script src="{% static 'post/collaborate/collaborate.js' %}"></script>
{% endblock %}